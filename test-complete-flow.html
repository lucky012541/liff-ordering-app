<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô - LIFF Ordering App</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; max-width: 800px; margin: 0 auto; }
        .test-section { margin: 20px 0; padding: 15px; border: 1px solid #ddd; border-radius: 8px; }
        .test-btn { background: #ff8c00; color: white; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer; margin: 5px; }
        .test-btn:hover { background: #e67e22; }
        .success { color: #28a745; }
        .error { color: #dc3545; }
        .info { color: #17a2b8; }

        /* Product grid styles for testing */
        #productsGrid { display: grid; grid-template-columns: repeat(auto-fill, minmax(250px, 1fr)); gap: 15px; margin: 20px 0; }
        .product-card { background: white; border: 1px solid #e9ecef; border-radius: 8px; overflow: hidden; cursor: pointer; transition: all 0.2s ease; }
        .product-card:hover { transform: translateY(-2px); box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08); }
        .product-icon { width: 100%; height: 120px; display: flex; align-items: center; justify-content: center; background: #fff5e6; color: #ff8c00; font-size: 2rem; }
        .product-info { padding: 15px; }
        .product-name { font-size: 1rem; font-weight: 600; margin-bottom: 5px; color: #333; }
        .product-description { color: #666; font-size: 0.9rem; margin-bottom: 10px; line-height: 1.4; }
        .product-price { font-size: 1.1rem; font-weight: 600; color: #ff8c00; margin-bottom: 10px; }
        .add-to-cart { width: 100%; padding: 8px; background: #ff8c00; color: white; border: none; border-radius: 5px; font-size: 0.9rem; cursor: pointer; transition: background 0.2s; }
        .add-to-cart:hover { background: #e67e22; }
        .loading { text-align: center; padding: 20px; color: #666; }
    </style>
</head>
<body>
    <h1>üß™ ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô LIFF Ordering App</h1>

    <div class="test-section">
        <h3>1. ‡∏Å‡∏≤‡∏£‡πÇ‡∏´‡∏•‡∏î‡πÅ‡∏≠‡∏õ‡∏û‡∏•‡∏¥‡πÄ‡∏Ñ‡∏ä‡∏±‡∏ô</h3>
        <button class="test-btn" onclick="testAppInitialization()">‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡πÇ‡∏´‡∏•‡∏î‡πÅ‡∏≠‡∏õ</button>
        <div id="init-result"></div>
    </div>

    <div class="test-section">
        <h3>2. ‡∏Å‡∏≤‡∏£‡πÅ‡∏™‡∏î‡∏á‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</h3>
        <button class="test-btn" onclick="testProductDisplay()">‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡πÅ‡∏™‡∏î‡∏á‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</button>
        <div id="product-result"></div>
    </div>

    <div class="test-section">
        <h3>3. ‡∏Å‡∏≤‡∏£‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡πÉ‡∏ô‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤</h3>
        <button class="test-btn" onclick="testAddToCart()">‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÉ‡∏ô‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤</button>
        <div id="cart-result"></div>
    </div>

    <div class="test-section">
        <h3>4. ‡∏Å‡∏≤‡∏£‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô</h3>
        <button class="test-btn" onclick="testPaymentFlow()">‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô</button>
        <div id="payment-result"></div>
    </div>

    <div class="test-section">
        <h3>5. ‡∏Å‡∏≤‡∏£‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠‡πÅ‡∏•‡∏∞‡πÉ‡∏ö‡πÄ‡∏™‡∏£‡πá‡∏à</h3>
        <button class="test-btn" onclick="testOrderCompletion()">‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠</button>
        <div id="order-result"></div>
    </div>

    <div class="test-section">
        <h3>6. ‡∏Å‡∏≤‡∏£‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠</h3>
        <button class="test-btn" onclick="testOrderTracking()">‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°</button>
        <div id="tracking-result"></div>
    </div>

    <script>
        function updateResult(elementId, message, type = 'info') {
            const element = document.getElementById(elementId);
            element.innerHTML = `<span class="${type}">${message}</span>`;
        }

        function testAppInitialization() {
            try {
                if (typeof app !== 'undefined') {
                    updateResult('init-result', '‚úÖ ‡πÅ‡∏≠‡∏õ‡πÇ‡∏´‡∏•‡∏î‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à', 'success');
                    return true;
                } else {
                    updateResult('init-result', '‚ùå ‡πÅ‡∏≠‡∏õ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡πÇ‡∏´‡∏•‡∏î', 'error');
                    return false;
                }
            } catch (error) {
                updateResult('init-result', `‚ùå ‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î: ${error.message}`, 'error');
                return false;
            }
        }

        function testProductDisplay() {
            try {
                if (typeof app !== 'undefined' && app.products) {
                    const productCount = app.products.length;
                    if (productCount > 0) {
                        updateResult('product-result', `‚úÖ ‡∏û‡∏ö‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤ ${productCount} ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö`, 'success');
                        return true;
                    } else {
                        updateResult('product-result', '‚ùå ‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö', 'error');
                        return false;
                    }
                } else {
                    updateResult('product-result', '‚ùå ‡πÅ‡∏≠‡∏õ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡πÇ‡∏´‡∏•‡∏î', 'error');
                    return false;
                }
            } catch (error) {
                updateResult('product-result', `‚ùå ‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î: ${error.message}`, 'error');
                return false;
            }
        }

        function testAddToCart() {
            try {
                if (typeof app !== 'undefined' && app.cart !== undefined) {
                    const initialCount = app.cart.length;
                    // Add first product to cart
                    app.addToCart(1, 1);
                    const newCount = app.cart.length;

                    if (newCount > initialCount) {
                        updateResult('cart-result', `‚úÖ ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡πÉ‡∏ô‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤‡πÅ‡∏•‡πâ‡∏ß (${newCount} ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£)`, 'success');
                        return true;
                    } else {
                        updateResult('cart-result', '‚ùå ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡πÉ‡∏ô‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤', 'error');
                        return false;
                    }
                } else {
                    updateResult('cart-result', '‚ùå ‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏£‡∏∞‡∏ö‡∏ö‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤', 'error');
                    return false;
                }
            } catch (error) {
                updateResult('cart-result', `‚ùå ‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î: ${error.message}`, 'error');
                return false;
            }
        }

        function testPaymentFlow() {
            try {
                // Test payment method selection
                const paymentMethods = document.querySelectorAll('input[name="paymentMethod"]');
                if (paymentMethods.length > 0) {
                    updateResult('payment-result', `‚úÖ ‡∏û‡∏ö‡∏ß‡∏¥‡∏ò‡∏µ‡∏Å‡∏≤‡∏£‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô ${paymentMethods.length} ‡∏ß‡∏¥‡∏ò‡∏µ`, 'success');
                    return true;
                } else {
                    updateResult('payment-result', '‚ùå ‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏ß‡∏¥‡∏ò‡∏µ‡∏Å‡∏≤‡∏£‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô', 'error');
                    return false;
                }
            } catch (error) {
                updateResult('payment-result', `‚ùå ‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î: ${error.message}`, 'error');
                return false;
            }
        }

        function testOrderCompletion() {
            try {
                if (typeof app !== 'undefined' && app.orders !== undefined) {
                    const orderCount = app.orders.length;
                    updateResult('order-result', `‚úÖ ‡∏£‡∏∞‡∏ö‡∏ö‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡πÑ‡∏î‡πâ (${orderCount} ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£)`, 'success');
                    return true;
                } else {
                    updateResult('order-result', '‚ùå ‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏£‡∏∞‡∏ö‡∏ö‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠', 'error');
                    return false;
                }
            } catch (error) {
                updateResult('order-result', `‚ùå ‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î: ${error.message}`, 'error');
                return false;
            }
        }

        function testOrderTracking() {
            try {
                if (typeof app !== 'undefined' && typeof app.showOrderTracking === 'function') {
                    updateResult('tracking-result', '‚úÖ ‡∏£‡∏∞‡∏ö‡∏ö‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô', 'success');
                    return true;
                } else {
                    updateResult('tracking-result', '‚ùå ‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏£‡∏∞‡∏ö‡∏ö‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠', 'error');
                    return false;
                }
            } catch (error) {
                updateResult('tracking-result', `‚ùå ‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î: ${error.message}`, 'error');
                return false;
            }
        }

        function runAllTests() {
            console.log('Running all tests...');
            const results = [];

            results.push(testAppInitialization());
            results.push(testProductDisplay());
            results.push(testPaymentFlow());
            results.push(testOrderCompletion());
            results.push(testOrderTracking());

            // Test cart functionality if app is loaded
            if (results[0]) { // If app initialization passed
                setTimeout(() => {
                    results.push(testAddToCart());
                    showTestSummary(results);
                }, 500);
            } else {
                showTestSummary(results);
            }
        }

        function showTestSummary(results) {
            const passed = results.filter(r => r === true).length;
            const total = results.length;

            const summaryDiv = document.createElement('div');
            summaryDiv.style.cssText = `
                margin-top: 30px;
                padding: 20px;
                border: 2px solid ${passed === total ? '#28a745' : '#ffc107'};
                border-radius: 10px;
                background: ${passed === total ? '#d4edda' : '#fff3cd'};
                text-align: center;
            `;
            summaryDiv.innerHTML = `
                <h3 style="margin: 0 0 10px 0; color: ${passed === total ? '#155724' : '#856404'}">
                    ${passed === total ? 'üéâ' : '‚ö†Ô∏è'} ‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏ó‡∏î‡∏™‡∏≠‡∏ö: ${passed}/${total} ‡∏ú‡πà‡∏≤‡∏ô
                </h3>
                <p style="margin: 0; font-weight: bold;">
                    ${passed === total ? '‡∏ó‡∏∏‡∏Å‡∏ü‡∏µ‡πÄ‡∏à‡∏≠‡∏£‡πå‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡πÑ‡∏î‡πâ‡∏õ‡∏Å‡∏ï‡∏¥!' : '‡∏û‡∏ö‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏ö‡∏≤‡∏á‡∏™‡πà‡∏ß‡∏ô ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö'}
                </p>
            `;

            document.body.appendChild(summaryDiv);
        }

        // Auto-run tests when page loads
        window.addEventListener('load', function() {
            // Wait for app to initialize
            let attempts = 0;
            const checkApp = setInterval(() => {
                attempts++;
                if (typeof app !== 'undefined' || attempts > 50) { // Wait up to 5 seconds
                    clearInterval(checkApp);
                    runAllTests();
                }
            }, 100);
        });
    </script>

    <!-- Load the main app HTML structure -->
    <div id="productsGrid" style="display: block; margin: 10px 0;"></div>
    <div id="checkoutModal" style="display: none;">
        <div class="modal-content">
            <div id="paymentDetailsPanel"></div>
        </div>
    </div>

    <!-- Required elements for the app to work -->
    <div id="loading" style="display: none;"></div>
    <div id="toast" style="display: none;"><div id="toastMessage"></div></div>
    <div id="userInfo"><span id="userName">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î...</span></div>

    <!-- Payment methods for testing -->
    <div style="display: none;">
        <input type="radio" name="paymentMethod" value="cash" checked>
        <input type="radio" name="paymentMethod" value="transfer">
        <input type="radio" name="paymentMethod" value="promptpay">
    </div>

    <!-- Load the main app -->
    <script src="script.js"></script>
    <!-- Load test script -->
    <script src="simple-test.js"></script>
</body>
</html>